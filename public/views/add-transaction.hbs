<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Expense</title>
      <link rel="stylesheet" href="/css/home.css">
      <link rel="stylesheet" href="/css/add-transaction.css">
      <script src="../script/add-transaction.scipt.js" defer></script>
</head>
<body>
       <div id="home">
        {{> homeHeader
            homeLink="/home" 
        }}
        <div id="panel">
            <div id="left-panel">
                <div id="left-panel-top">
                    <ul>
                        <li>Goals</li>
                        <li>Budget</li>
                        <li>Savings</li>
                        <li>Reports</li>
                        <li>Groups</li>
                    </ul>
                </div>
                <div id="left-panel-bottom">
                    <ul>
                        <li>Custom Categories</li>
                        <li>Profile</li>
                        <li><a href='/auth/logout'>Log out</a></li>
                    </ul>
                </div>
            </div>

            <div id="right-panel">
                <label for="formType">Select Transaction Type:</label>
               <select id="formType" onchange="toggleForm()">
                    <option value="debit-from">Debit</option>
                    <option value="credit-form">Credit</option>
                </select>

                <form class="formDiv" id="debit-form" style="display:block;">
                    <div class="form-group">
                        <label for="amount">Amount:</label>
                        <input type="number" id="amount" name="amount" required>
                    </div>
                    <div class="form-group">
                        <label for="date">Date:</label>
                        <input type="date" id="date" name="date" required>
                    </div>
                    <div class="form-group">
                        <label for="purpose">Purpose:</label>
                        <input type="text" id="purpose" name="purpose" required>
                    </div>
                    <div class="form-group">
                        <label for="modeOfPayment">Mode of Payment:</label>
                        <select id="modeOfPayment" name="modeOfPayment" required>
                            <option value="">All Modes</option>
                            <option value="paytm">Paytm</option>
                            <option value="phone pe">Phone pe</option>
                            <option value="google pay">Google pay</option>
                            <option value="cash">Cash</option>
                            <option value="debit card">Debit Card</option>
                            <option value="credit card">Credit Card</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <button id="form-button" type="submit">Add Debit</button>
                    <p id="message"></p>
                </form>
                <form class="formDiv" id="credit-form" style="display:none;">
                    <div class="form-group">
                        <label for="amount">Amount:</label>
                        <input type="number" id="amount" name="amount" required>
                    </div>
                    <div class="form-group">
                        <label for="date">Date:</label>
                        <input type="date" id="date" name="date" required>
                    </div>
                    <div class="form-group">
                        <label for="modeOfPayment">Mode of Payment:</label>
                        <select id="modeOfPayment" name="modeOfPayment" required>
                            <option value="">All Modes</option>
                            <option value="paytm">Paytm</option>
                            <option value="phone pe">Phone pe</option>
                            <option value="google pay">Google pay</option>
                            <option value="cash">Cash</option>
                            <option value="debit card">Debit Card</option>
                            <option value="credit card">Credit Card</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="purpose">Bank Account:</label>
                        <input type="text" id="bank" name="bank" required>
                    </div>
                    <button id="form-button" type="submit">Add Credit</button>
                    <p id="message"></p>
                </form>
            </div>
        </div>
    </div>
    <style>
      #add-link a{
            border-radius: 50px;
            font-size: 15px;
            text-decoration: none;
            background-color: #83bce3;
            color: black;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.3);
        }
    </style>
     <div class="upload-container">
    <input type="file" id="imageInput" accept="image/*">
    <button class="select-button" onclick="document.getElementById('imageInput').click()">
        Select Image
    </button>
</div>

<script type="module">
    import { handleScan } from '../script/geminiapi.js';

    const imageInput = document.getElementById('imageInput');

    imageInput.addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (file && file.type.startsWith('image/')) {
            console.log("Scanning image...");

            try {
                const response = await handleScan(file);

                if (response && response.success) {
                    console.log("Scan Successful:", response.analysis);
                } else {
                    console.error("Scan Failed:", response.error);
                }
            } catch (error) {
                console.error("Error:", error.message);
            }
        } else {
            alert('Please select an image file');
        }
    });
</script>
</body>
</html>
